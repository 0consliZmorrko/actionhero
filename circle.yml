---
machine:
  environment:
    FAKEREDIS: false
    maxMemoryAlloted: 500
  node:
    version: 8
  services:
    - redis
test:
  pre:
    - "rm -rf node_modules"
  override:
    - >
      "case $CIRCLE_NODE_INDEX in
      0) nvm install 4 && nvm use 4 && npm install && npm test ;;
      1) nvm install 6 && nvm use 6 && npm install && npm test ;;
      2) nvm install 8 && nvm use 8 && npm install && npm test ;;
      esac;"
        parallel: true
